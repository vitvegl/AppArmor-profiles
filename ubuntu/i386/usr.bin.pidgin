/usr/bin/pidgin {

capability mknod,

network inet stream,
network inet dgram,

unix (create, getattr) type=stream addr=none,
unix (send, receive, connect) type=stream addr=none peer=(addr=@/tmp/.X11-unix/X0),
unix (send, receive) addr=none peer=(addr=none),
unix (send, receive, connect) type=stream addr=none peer=(addr=@/tmp/dbus-*),
unix create type=dgram addr=none,

dbus send
 bus=system
 path=/org/freedesktop/DBus
 interface=org.freedesktop.DBus
 member=Hello
 peer=(name=org.freedesktop.DBus),

dbus send
 bus=system
 path=/org/freedesktop/DBus
 interface=org.freedesktop.DBus
 member=AddMatch
 peer=(name=org.freedesktop.DBus),

dbus send
 bus=system
 path=/org/freedesktop/DBus
 interface=org.freedesktop.DBus
 member=RemoveMatch
 peer=(name=org.freedesktop.DBus),

dbus send
 bus=system
 path=/org/freedesktop/DBus
 interface=org.freedesktop.DBus
 member=GetNameOwner
 peer=(name=org.freedesktop.DBus),

# checking NetworkManager state

dbus send
 bus=system
 path=/org/freedesktop/NetworkManager
 interface=org.freedesktop.NetworkManager
 member=state
 peer=(name=org.freedesktop.NetworkManager),

/run/dbus/system_bus_socket rw,
/run/systemd/journal/dev-log w,

/etc/ld.so.cache r,

/etc/hosts r,
/etc/host.conf r,
/etc/machine-id r,
/etc/nsswitch.conf r,
/etc/passwd r,
/etc/resolv.conf r,

/proc/filesystems r,
/sys/devices/system/cpu/online r,
/proc/{cpuinfo,stat} r,

owner /proc/*/loginuid r,

/dev/urandom r,

/etc/fonts/{,**} r,
/etc/locale.alias r,
/usr/lib/locale/{,**} r,
/usr/share/{icons,enchant,fontconfig,fonts,locale,mime,pixmaps,poppler,themes,X11}/{,**} r,
/usr/local/share/fonts/{,**} r,

/var/cache/fontconfig/{,**} r,
/var/lib/aspell/{,**} r,

owner /home/*/.Xauthority r,
owner /home/*/.cache/gstreamer-*/{,**} rw,
owner /home/*/.cache/thumbnails/{,**} r,
owner /home/*/.config/enchant/{,**} rw,
owner /home/*/.gtk-[23].0/{,**} r,
owner /home/*/.gtkrc-?.0 r,
owner /home/*/.icons/{,**} r,
owner /home/*/.local/share/recently-used.xbel{,.*} rw,
owner /home/*/.purple/{,**} rwkl,

/usr/lib/pidgin/{,**} rm,
/usr/lib/purple-?/{,**} rm,
/usr/lib/sasl2/{,**} rm,
/usr/lib/i386-linux-gnu/sasl2/{,**} rm,
/usr/lib/i386-linux-gnu/libnspr4.so rm,
/usr/lib/i386-linux-gnu/libdb*.so rm,
/usr/lib/i386-linux-gnu/libnss?.so rm,
/usr/lib/i386-linux-gnu/libnssutil?.so rm,
/usr/lib/i386-linux-gnu/libsmime?.so rm,
/usr/lib/i386-linux-gnu/libplc?.so rm,
/usr/lib/i386-linux-gnu/libplds4.so rm,
/lib/i386-linux-gnu/libnsl*.so{,.?} rm,
/usr/lib/i386-linux-gnu/gconv/{,**} rm,

/usr/lib/i386-linux-gnu/gtk-?.0/{,**} rm,
/usr/lib/i386-linux-gnu/enchant/{,**} rm,
/usr/lib/i386-linux-gnu/gio/{,**} rm,
/usr/lib/i386-linux-gnu/gdk-pixbuf-?.0/{,**} rm,
/usr/lib/aspell/{,**} rm,
/usr/lib/i386-linux-gnu/gstreamer*/{,**} rm,
/usr/lib/i386-linux-gnu/libunity/{,**} rm,
/usr/lib/i386-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-plugin-scanner rix,

/usr/lib/i386-linux-gnu/nss/{,**} rm,

/usr/lib/i386-linux-gnu/libicui18n.so.* rm,

/usr/lib/i386-linux-gnu/libdbusmenu-glib.so.* rm,

/usr/lib/i386-linux-gnu/libdee*.so.* rm,

/usr/lib/i386-linux-gnu/libmessaging-menu.so.* rm,

/usr/lib/i386-linux-gnu/libunity.so.* rm,

/lib/i386-linux-gnu/libcrypt*.so{,.?} rm,

/lib/i386-linux-gnu/libnss_{compat,files,nis}*.so{,.?} rm,

/lib/i386-linux-gnu/libcom_err.so.* rm,

/usr/lib/i386-linux-gnu/libavahi-glib.so.* rm,

/usr/lib/i386-linux-gnu/libzephyr.so.* rm,

/usr/lib/libmeanwhile.so.* rm,

/usr/lib/i386-linux-gnu/libavahi-client.so.* rm,

/lib/i386-linux-gnu/libcrypto.so.* rm,

/usr/lib/i386-linux-gnu/libperl.so.* rm,

/usr/lib/i386-linux-gnu/libavahi-common.so.* rm,

/usr/lib/i386-linux-gnu/libsasl2.so.* rm,
/usr/lib/i386-linux-gnu/libssl3.so rm,

/usr/lib/i386-linux-gnu/libgstbasecamerabinsrc*.so.* rm,

/lib/i386-linux-gnu/libncurses.so.* rm,

/usr/lib/i386-linux-gnu/libtheoradec.so.* rm,

/usr/lib/i386-linux-gnu/librom1394.so.* rm,

/usr/lib/i386-linux-gnu/libcdda_paranoia.so.* rm,

/usr/lib/i386-linux-gnu/libgstrtsp*.so.* rm,

/usr/lib/i386-linux-gnu/libv4l2.so.* rm,

/usr/lib/i386-linux-gnu/libtheora.so.* rm,

/lib/i386-linux-gnu/libbz2.so.* rm,

/lib/i386-linux-gnu/libslang.so.* rm,

/usr/lib/i386-linux-gnu/libvorbisenc.so.* rm,

/usr/lib/libgssdp*.so.* rm,

/usr/lib/i386-linux-gnu/sse2/libspeex.so.* rm,

/usr/lib/i386-linux-gnu/libspeex.so.* rm,

/usr/lib/i386-linux-gnu/libgstphotography*.so.* rm,

/usr/lib/i386-linux-gnu/libgstapp*.so.* rm,

/usr/lib/i386-linux-gnu/libaa.so.* rm,

/usr/lib/i386-linux-gnu/libvpx.so.* rm,

/usr/lib/i386-linux-gnu/libjpeg.so.* rm,

/usr/lib/i386-linux-gnu/libtheoraenc.so.* rm,

/usr/lib/i386-linux-gnu/libwavpack.so.* rm,

/usr/lib/i386-linux-gnu/libavc1394.so.* rm,

/usr/lib/i386-linux-gnu/libdv.so.* rm,

/usr/lib/i386-linux-gnu/libcdda_interface.so.* rm,

/usr/lib/i386-linux-gnu/libgstallocators*.so.* rm,

/usr/lib/i386-linux-gnu/libshout.so.* rm,

/usr/lib/i386-linux-gnu/libtag.so.* rm,

/usr/lib/i386-linux-gnu/libgstriff*.so.* rm,

/usr/lib/i386-linux-gnu/libcaca.so.* rm,

/usr/lib/i386-linux-gnu/libvorbis.so.* rm,

/usr/lib/i386-linux-gnu/libsqlite3.so.* rm,

/usr/lib/i386-linux-gnu/libogg.so.* rm,

/usr/lib/libgupnp*.so.* rm,

/usr/lib/i386-linux-gnu/libgupnp-igd*.so.* rm,

/usr/lib/i386-linux-gnu/libsoup*.so.* rm,

/usr/lib/i386-linux-gnu/libgstfft*.so.* rm,

/usr/lib/i386-linux-gnu/libFLAC.so.* rm,

/usr/lib/i386-linux-gnu/libjack.so.* rm,

/usr/lib/i386-linux-gnu/libnice.so.* rm,

/usr/lib/i386-linux-gnu/libgstrtp*.so.* rm,

/usr/lib/i386-linux-gnu/libvisual*.so.* rm,

/usr/lib/i386-linux-gnu/libgstnet*.so.* rm,

/usr/lib/i386-linux-gnu/liborc-test*.so.* rm,

/usr/lib/i386-linux-gnu/libgsttag*.so.* rm,

/usr/lib/i386-linux-gnu/libcroco*.so.* rm,

/usr/lib/i386-linux-gnu/libgstaudio*.so.* rm,

/usr/lib/i386-linux-gnu/libcairo-gobject.so.* rm,

/usr/lib/i386-linux-gnu/libgstpbutils*.so.* rm,

/usr/lib/i386-linux-gnu/librsvg*.so.* rm,

/lib/i386-linux-gnu/libudev.so.* rm,

/usr/lib/i386-linux-gnu/gvfs/libgvfscommon.so rm,

/usr/lib/i386-linux-gnu/libfcitx-utils.so.* rm,

/usr/lib/i386-linux-gnu/libfcitx-gclient.so.* rm,

/usr/lib/i386-linux-gnu/libxkbcommon.so.* rm,

/usr/lib/i386-linux-gnu/libhunspell*.so.* rm,

/usr/lib/i386-linux-gnu/libaspell.so.* rm,

/usr/lib/i386-linux-gnu/libstdc++.so.* rm,

/usr/lib/i386-linux-gnu/libicudata.so.* rm,

/usr/lib/i386-linux-gnu/libgraphite*.so.* rm,

/lib/i386-linux-gnu/libgpg-error.so.* rm,

/usr/lib/i386-linux-gnu/liborc*.so.* rm,

/usr/lib/i386-linux-gnu/libgstbase*.so.* rm,

/usr/lib/i386-linux-gnu/libicuuc.so.* rm,

/usr/lib/i386-linux-gnu/libdatrie.so.* rm,

/lib/i386-linux-gnu/libexpat.so.* rm,

/usr/lib/i386-linux-gnu/libharfbuzz.so.* rm,

/lib/i386-linux-gnu/libselinux.so.? rm,

/usr/lib/i386-linux-gnu/libXdmcp.so.* rm,

/usr/lib/i386-linux-gnu/libXau.so.* rm,

/lib/i386-linux-gnu/libgcc_s.so.? rm,

/lib/i386-linux-gnu/libgcrypt.so.* rm,

/lib/i386-linux-gnu/liblzma.so.* rm,

/lib/i386-linux-gnu/libresolv*.so{,.?} rm,

/usr/lib/i386-linux-gnu/libidn.so.* rm,

/usr/lib/i386-linux-gnu/libgstvideo*.so.* rm,

/usr/lib/i386-linux-gnu/libfarstream*.so.* rm,

/usr/lib/i386-linux-gnu/libxml2.so.* rm,

/usr/lib/i386-linux-gnu/libdbus-glib*.so.* rm,

/lib/i386-linux-gnu/libpcre.so.* rm,

/usr/lib/i386-linux-gnu/libffi.so.* rm,

/usr/lib/i386-linux-gnu/libthai.so.* rm,

/lib/i386-linux-gnu/libz.so.* rm,

/usr/lib/i386-linux-gnu/libxcb-render.so.* rm,

/usr/lib/i386-linux-gnu/libxcb-shm.so.* rm,

/usr/lib/i386-linux-gnu/libpng12.so.* rm,
/lib/i386-linux-gnu/libpng12.so.* rm,

/usr/lib/i386-linux-gnu/libfreetype.so.* rm,

/usr/lib/i386-linux-gnu/libpixman*.so.* rm,

/usr/lib/i386-linux-gnu/libXdamage.so.* rm,

/usr/lib/i386-linux-gnu/libXcomposite.so.* rm,

/usr/lib/i386-linux-gnu/libXcursor.so.* rm,

/usr/lib/i386-linux-gnu/libXrandr.so.* rm,

/usr/lib/i386-linux-gnu/libXi.so.* rm,

/usr/lib/i386-linux-gnu/libXinerama.so.* rm,

/usr/lib/i386-linux-gnu/libXrender.so.* rm,

/usr/lib/i386-linux-gnu/libfontconfig.so.* rm,

/usr/lib/i386-linux-gnu/libpangoft2-1.0.so.* rm,

/usr/lib/i386-linux-gnu/libgio*.so.* rm,

/usr/lib/i386-linux-gnu/libXfixes.so.* rm,

/usr/lib/i386-linux-gnu/libpangocairo*.so.* rm,

/usr/lib/i386-linux-gnu/libenchant.so.* rm,

/lib/i386-linux-gnu/libuuid.so.* rm,

/usr/lib/i386-linux-gnu/libXext.so.* rm,

/usr/lib/i386-linux-gnu/libxcb.so.* rm,

/lib/i386-linux-gnu/lib{c,dl,m,rt}*.so{,.?} rm,

/usr/lib/i386-linux-gnu/libgmodule*.so.* rm,

/lib/i386-linux-gnu/libsystemd.so.* rm,

/lib/i386-linux-gnu/libpthread*.so{,.?} rm,

/usr/lib/libpurple.so.* rm,

/lib/i386-linux-gnu/libglib*.so.* rm,

/usr/lib/i386-linux-gnu/libgobject*.so.* rm,

/usr/lib/i386-linux-gnu/libpango*.so.* rm,

/usr/lib/i386-linux-gnu/libgdk_pixbuf*.so.* rm,

/usr/lib/i386-linux-gnu/libcairo.so.* rm,

/usr/lib/i386-linux-gnu/libatk*.so.* rm,

/usr/lib/i386-linux-gnu/libg[dt]k-x11*.so.* rm,

/usr/lib/libgtkspell.so.* rm,

/usr/lib/i386-linux-gnu/libICE.so.* rm,

/usr/lib/i386-linux-gnu/libSM.so.* rm,

/lib/i386-linux-gnu/libdbus*.so.* rm,

/usr/lib/i386-linux-gnu/libgstreamer*.so.* rm,

/usr/lib/i386-linux-gnu/libX11.so.* rm,

/usr/lib/i386-linux-gnu/libXss.so.* rm,

/var/tmp/{,**} rw,
/tmp/ r,
#/tmp/{[a-z],[0-9]}*/{,**} rw,

deny /tmp/{systemd,ssh,qt}*/{,**} rw,

}
