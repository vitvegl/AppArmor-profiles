/usr/lib/firefox/firefox{,*[^s][^h]} {

#include <abstractions/gconv-amd64>

dbus,
network,
capability mknod,

signal (send) set=("vtalrm") peer="/usr/lib/firefox/firefox{,*[^s][^h]}",
signal (receive) set=("vtalrm") peer="/usr/lib/firefox/firefox{,*[^s][^h]}",

signal (send) set=("exists") peer="/usr/lib/firefox/firefox{,*[^s][^h]}",
signal (receive) set=("exists") peer="/usr/lib/firefox/firefox{,*[^s][^h]}",

signal (send) set=("exists") peer=unconfined,
signal (receive) set=("exists") peer=unconfined,

signal (send) set=("kill") peer=unconfined,
signal (receive) set=("kill") peer=unconfined,

/var/lib/dbus/machine-id r,

/proc/{,**} r,

/sys/devices/{,**} r,
/sys/devices/system/cpu/online r,

owner /run/user/*/pulse/{,**} rw,
owner /run/user/*/dconf/user rw,

deny /tmp/[a-z]*.exe rw,
deny /tmp/_[a-z]*.exe rw,
owner /tmp/[a-z]* rw,
owner /tmp/_[a-z]* rw,
owner /tmp/[a-z]*.tar{,.*} rw,
owner /tmp/mozilla_mozillaUser0/{,**} rw,
owner /home/*/Downloads/{,**} rw,
owner /home/*/.cache/event-sound-cache.tdb.*.x86_64-pc-linux-gnu r,
owner /home/*/.cache/mozilla/{,**} rwlk,
owner /home/*/.config/mozilla/{,**} rwlk,
owner /home/*/.config/user-dirs.dirs r,
owner /home/*/.icons/{,**} r,
owner /home/*/.Xauthority r,
owner /home/*/.mozilla/{,**} rw,
owner /home/*/.gtkrc-2.0 r,
owner /home/*/.gtk-bookmarks r,
owner /home/*/.local/share/applications/{,**} r,
owner /home/*/.config/dconf/user r,
owner /home/*/.cache/event-sound-cache.tdb.*.x86_64-pc-linux-gnu rw,
owner /home/*/.local/share/recently-used.xbel r,
owner /home/*/.config/gtk-2.0/{,**} rw,

/var/tmp/{,**} rw,
/tmp/ r,
deny /tmp/.[a-z]*/{,**} rwklmx,
deny /tmp/.[A-Z]*/{,**} rwklmx,
deny /tmp/.[0-9]*/{,**} rwlkmx,
deny /tmp/tmux*/{,**} rw,
deny /tmp/systemd*/{,**} rwklmx,
deny /tmp/ssh*/{,**} rwklmx,

/etc/ld.so.cache r,
/etc/passwd r,

/dev/null rw,
/dev/shm/ r,
/dev/shm/pulse-shm* rw,
/dev/urandom r,

/run/udev/data/+pci* r,

/var/cache/fontconfig/{,**} r,

/dev/dri/card0 rw,
/sys/devices/pci*/**/uevent r,

/etc/drirc r,
/etc/fonts/{,**} r,
/etc/gnome/defaults.list r,
/etc/hosts r,
/etc/host.conf r,
/etc/localtime r,
/etc/lsb-release r,
/etc/machine-id r,
/etc/mailcap r,
/etc/mime.types r,
/etc/nsswitch.conf r,
/etc/pulse/client.conf r,
/etc/resolv.conf r,
/etc/udev/udev.conf r,

/usr/share/applications/{,**} r,
/usr/share/fonts/{,**} r,
/usr/share/fontconfig/{,**} r,
/usr/share/fonts-droid/{,**} r,
/usr/share/hunspell/{,**} r,
/usr/share/mate/{,**} r,
/usr/share/mozilla/{,**} r,

/etc/locale.alias r,

/usr/lib/firefox/{,**} r,
/usr/lib/firefox-addons/plugins/{,**} r,

/usr/lib/firefox-addons/extensions/{,**} r,

/usr/share/glib-2.0/schemas/gschemas.compiled r,

/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules.cache r,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules/im-am-et.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules/im-cedilla.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules/im-cyrillic-translit.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules/im-inuktitut.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules/im-ipa.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules/im-multipress.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules/im-thai.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules/im-ti-er.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules/im-ti-et.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules/im-viqr.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/immodules/im-xim.so rm,

/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/printbackends/libprintbackend-cups.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/printbackends/libprintbackend-file.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/printbackends/libprintbackend-lpr.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/printbackends/libprintbackend-test.so rm,

/usr/lib/x86_64-linux-gnu/libXss.so.* rm,
/usr/lib/x86_64-linux-gnu/libwayland-client.so.* rm,
/usr/lib/x86_64-linux-gnu/libxkbcommon.so.* rm,
/usr/lib/x86_64-linux-gnu/libwayland-cursor.so.* rm,
/usr/lib/x86_64-linux-gnu/libmirclient.so.? rm,
/usr/lib/x86_64-linux-gnu/libmircommon.so.? rm,
/usr/lib/x86_64-linux-gnu/libmirprotobuf.so.> rm,
/usr/lib/x86_64-linux-gnu/libboost_system.so.* rm,
/usr/lib/x86_64-linux-gnu/libboost_filesystem.so.* rm,
/usr/lib/x86_64-linux-gnu/libprotobuf.so.* rm,
/usr/lib/x86_64-linux-gnu/libavcodec.so.* rm,
/usr/lib/x86_64-linux-gnu/libdbusmenu-{glib,gtk}.so.* rm,
/usr/lib/x86_64-linux-gnu/libgconf*.so.* rm,
/usr/lib/x86_64-linux-gnu/libgmp.so.* rm,
/usr/lib/x86_64-linux-gnu/libhogweed.so.* rm,
/usr/lib/x86_64-linux-gnu/libnettle.so.* rm,
/usr/lib/x86_64-linux-gnu/libtasn1.so.* rm,
/usr/lib/x86_64-linux-gnu/libproxy.so.* rm,
/usr/lib/x86_64-linux-gnu/libgnutls-deb0.so.* rm,
/usr/lib/x86_64-linux-gnu/libp11-kit.so.* rm,

/usr/lib/x86_64-linux-gnu/gvfs/libgvfscommon.so rm,

/usr/lib/x86_64-linux-gnu/gio/modules/ r,
/usr/lib/x86_64-linux-gnu/gio/modules/giomodule.cache r,
/usr/lib/x86_64-linux-gnu/gio/modules/libdconfsettings.so rm,
/usr/lib/x86_64-linux-gnu/gio/modules/libgiognomeproxy.so rm,
/usr/lib/x86_64-linux-gnu/gio/modules/libgiognutls.so rm,
/usr/lib/x86_64-linux-gnu/gio/modules/libgiolibproxy.so rm,
/usr/lib/x86_64-linux-gnu/gio/modules/libgioremote-volume-monitor.so rm,
/usr/lib/x86_64-linux-gnu/gio/modules/libgvfsdbus.so rm,

/usr/lib/x86_64-linux-gnu/libpciaccess.so.* rm,
/usr/lib/x86_64-linux-gnu/libdrm_intel.so.* rm,
/lib/x86_64-linux-gnu/libudev.so.* rm,
/usr/lib/x86_64-linux-gnu/dri/i965_dri.so rm,
/usr/lib/x86_64-linux-gnu/libicudata.so.* rm,
/usr/lib/x86_64-linux-gnu/libicuuc.so.* rm,
/usr/lib/x86_64-linux-gnu/libxml2.so.* rm,
/usr/lib/x86_64-linux-gnu/libcroco*.so.* rm,
/usr/lib/x86_64-linux-gnu/librsvg*.so.* rm,

/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders.cache r,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-ani.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-bmp.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-gif.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-icns.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-ico.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-jpeg.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-png.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-pnm.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-qtif.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-svg.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-tga.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-tiff.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-xbm.so rm,
/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/2.10.0/loaders/libpixbufloader-xpm.so rm,

/usr/local/share/fonts/{,**} r,
/usr/share/alsa/{,**} r,
/usr/share/fonts/{,**} r,
/usr/share/icons/{,**} r,
/usr/share/javascript/{,**} r,
/usr/share/mime/{,**} r,
/usr/share/pixmaps/{,**} r,
/usr/share/poppler/{,**} r,
/usr/share/sounds/{,**} r,
/usr/share/X11/{,**} r,
/usr/share/themes/{,**} r,

/usr/lib/x86_64-linux-gnu/libspeexdsp.so.* rm,
/usr/lib/x86_64-linux-gnu/liborc*.so.* rm,

/lib/x86_64-linux-gnu/libcap.so.* rm,

/usr/bin/pulseaudio ix,
/usr/lib/libpulsecore-*.so rm,

/usr/lib/x86_64-linux-gnu/libvorbisenc.so.* rm,
/usr/lib/x86_64-linux-gnu/libFLAC.so.* rm,
/lib/x86_64-linux-gnu/libnsl*.so rm,
/usr/lib/x86_64-linux-gnu/libasyncns.so.* rm,
/usr/lib/x86_64-linux-gnu/libsndfile.so.* rm,
/lib/x86_64-linux-gnu/libwrap.so.* rm,

/usr/lib/x86_64-linux-gnu/pulseaudio/libpulsecommon*.so rm,

/usr/lib/firefox/crashreporter ix,
/usr/lib/firefox/crashreporter.ini r,

/lib/x86_64-linux-gnu/libjson-c.so.* rm,

/usr/lib/x86_64-linux-gnu/libpulse.so.* rm,
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_conf_pulse.so rm,
/usr/lib/x86_64-linux-gnu/libcanberra-*/libcanberra-alsa.so rm,
/usr/lib/x86_64-linux-gnu/libcanberra-*/libcanberra-pulse.so rm,

/usr/lib/firefox/defaults/pref/ r,
/usr/lib/firefox/defaults/pref/channel-prefs.js r,
/usr/lib/firefox/defaults/pref/vendor-gre.js r,

/usr/lib/firefox/browser/defaults/preferences/ r,
/usr/lib/firefox/browser/defaults/preferences/syspref.js r,
/etc/firefox/syspref.js r,
/usr/lib/firefox/browser/defaults/preferences/vendor-firefox.js r,

/usr/lib/x86_64-linux-gnu/libtxc_dxtn.so r,
/etc/alternatives/libtxc-dxtn-x86_64-linux-gnu r,
/usr/lib/x86_64-linux-gnu/libtxc_dxtn_s2tc.so.* rm,
/lib/x86_64-linux-gnu/libbsd.so.* rm,
/lib/x86_64-linux-gnu/libtinfo.so.* rm,
/usr/lib/x86_64-linux-gnu/libedit.so.* rm,
/usr/lib/x86_64-linux-gnu/libLLVM*.so.* rm,
/usr/lib/x86_64-linux-gnu/libelf*.so.* rm,
/usr/lib/x86_64-linux-gnu/libdrm_amdgpu.so.* rm,
/usr/lib/x86_64-linux-gnu/libdrm_radeon.so.* rm,
/usr/lib/x86_64-linux-gnu/libdrm_nouveau.so.* rm,

/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/ r,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/libclearlooks.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/libcrux-engine.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/libglide.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/libhcengine.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/libindustrial.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/libmist.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/libmist.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/libmurrine.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/libpixmap.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/libredmond95.so rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/2.10.0/engines/libthinice.so rm,

/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so rm,
/lib/x86_64-linux-gnu/libnss_mdns4_minimal.so.? rm,

/lib/x86_64-linux-gnu/libnss_dns*.so{,.?} rm,
/lib/x86_64-linux-gnu/libnss_files*.so{,.?} rm,

/usr/lib/firefox/chrome.manifest r,
/usr/lib/firefox/browser/chrome.manifest r,

/usr/lib/firefox/components/components.manifest r,
/usr/lib/firefox/browser/components/components.manifest r,
/usr/lib/firefox/browser/components/libbrowsercomps.so rm,
/usr/lib/firefox/components/libmozgnome.so rm,

/usr/lib/firefox/omni.ja r,
/usr/lib/firefox/browser/omni.ja r,

/usr/lib/x86_64-linux-gnu/libogg.so.* rm,
/usr/lib/x86_64-linux-gnu/libvorbis.so.* rm,
/usr/lib/x86_64-linux-gnu/libltdl.so.* rm,
/usr/lib/x86_64-linux-gnu/libtdb.so.* rm,

/usr/lib/locale/locale-archive r,
/usr/share/locale/locale.alias r,

/usr/lib/x86_64-linux-gnu/libvorbisfile.so.* rm,
/usr/lib/x86_64-linux-gnu/libcanberra*.so.* rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/modules/libcanberra-gtk-module.so rm,
/usr/lib/x86_64-linux-gnu/libgailutil.so.* rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/modules/libgail.so rm,
/usr/lib/x86_64-linux-gnu/libatspi.so.* rm,
/usr/lib/x86_64-linux-gnu/libatk-bridge*.so.* rm,
/usr/lib/x86_64-linux-gnu/gtk-2.0/modules/libatk-bridge.so rm,
/usr/lib/x86_64-linux-gnu/libdrm.so.* rm,
/usr/lib/x86_64-linux-gnu/libXxf86vm.so.* rm,
/usr/lib/x86_64-linux-gnu/libxshmfence.so.* rm,
/usr/lib/x86_64-linux-gnu/libxcb-sync.so.* rm,
/usr/lib/x86_64-linux-gnu/libxcb-present.so.* rm,
/usr/lib/x86_64-linux-gnu/libxcb-dri3.so.* rm,
/usr/lib/x86_64-linux-gnu/libxcb-dri2.so.* rm,
/usr/lib/x86_64-linux-gnu/libxcb-glx.so.* rm,
/usr/lib/x86_64-linux-gnu/libglapi.so.* rm,
/usr/lib/x86_64-linux-gnu/mesa/libGL.so.* rm,
/usr/lib/x86_64-linux-gnu/libgraphite*.so.* rm,
/lib/x86_64-linux-gnu/libgpg-error.so.* rm,
/lib/x86_64-linux-gnu/libuuid.so.* rm,
/usr/lib/x86_64-linux-gnu/libXdmcp.so.* rm,
/usr/lib/x86_64-linux-gnu/libXau.so.* rm,
/usr/lib/x86_64-linux-gnu/libdatrie.so.* rm,
/usr/lib/x86_64-linux-gnu/libharfbuzz.so.* rm,
/lib/x86_64-linux-gnu/libgcrypt.so.* rm,
/lib/x86_64-linux-gnu/liblzma.so.* rm,
/usr/lib/x86_64-linux-gnu/libICE.so.* rm,
/usr/lib/x86_64-linux-gnu/libSM.so.* rm,
/usr/lib/x86_64-linux-gnu/libX11-xcb.so.* rm,
/usr/lib/x86_64-linux-gnu/libxcb-util.so.* rm,
/usr/lib/x86_64-linux-gnu/libxcb.so.* rm,
/usr/lib/x86_64-linux-gnu/libxcb-render.so.* rm,
/usr/lib/x86_64-linux-gnu/libxcb-shm.so.* rm,
/usr/lib/x86_64-linux-gnu/libpixman*.so.* rm,
/usr/lib/x86_64-linux-gnu/libthai.so.* rm,
/usr/lib/x86_64-linux-gnu/libXcursor.so.* rm,
/usr/lib/x86_64-linux-gnu/libXrandr.so.* rm,
/usr/lib/x86_64-linux-gnu/libXi.so.* rm,
/usr/lib/x86_64-linux-gnu/libXinerama.so.* rm,
/lib/x86_64-linux-gnu/libresolv*.so{,.?} rm,
/lib/x86_64-linux-gnu/libselinux.so.? rm,
/usr/lib/x86_64-linux-gnu/libpango*.so.* rm,
/usr/lib/x86_64-linux-gnu/libgmodule*.so.* rm,

/lib/x86_64-linux-gnu/libpcre.so.* rm,
/usr/lib/x86_64-linux-gnu/libffi.so.* rm,
/lib/x86_64-linux-gnu/libsystemd.so.* rm,
/lib/x86_64-linux-gnu/libexpat.so.* rm,
/usr/lib/x86_64-linux-gnu/libpng12.so.? r,
/lib/x86_64-linux-gnu/libpng12.so.* rm,
/usr/lib/x86_64-linux-gnu/libpng12.so.? r,
/lib/x86_64-linux-gnu/libpng12.so.? rm,

/lib/x86_64-linux-gnu/libz.so.* rm,
/usr/lib/x86_64-linux-gnu/libgthread*.so.* rm,

/usr/lib/x86_64-linux-gnu/libXt.so.* rm,
/usr/lib/x86_64-linux-gnu/libX11.so.* rm,
/usr/lib/x86_64-linux-gnu/libstartup-notification*.so.* rm,
/usr/lib/x86_64-linux-gnu/libgdk*.so.* rm,
/usr/lib/x86_64-linux-gnu/libcairo*.so.* rm,
/usr/lib/x86_64-linux-gnu/libpango*.so.* rm,
/usr/lib/x86_64-linux-gnu/libgio*.so.* rm,
/usr/lib/x86_64-linux-gnu/lib[ag]tk*.so.* rm,
/lib/x86_64-linux-gnu/libglib*.so.* rm,
/usr/lib/x86_64-linux-gnu/libgobject*.so.* rm,
/lib/x86_64-linux-gnu/libdbus*.so.* rm,
/usr/lib/x86_64-linux-gnu/libasound.so.* rm,
/usr/lib/x86_64-linux-gnu/libdbus-glib-*.so.* rm,
/lib/x86_64-linux-gnu/libpthread*.so{,.?} rm,
/lib/x86_64-linux-gnu/libdl*.so{,.?} rm,

/usr/lib/x86_64-linux-gnu/libstdc++.so.* rm,
/lib/x86_64-linux-gnu/libc*.so{,.?} rm,
/lib/x86_64-linux-gnu/libm*.so{,.?} rm,
/lib/x86_64-linux-gnu/librt*.so{,.?} rm,
/lib/x86_64-linux-gnu/libgcc_s.so.? rm,

/usr/lib/firefox/dependentlibs.list r,
/usr/lib/firefox/libnspr4.so rm,
/usr/lib/firefox/libplc4.so rm,
/usr/lib/firefox/libplds4.so rm,
/usr/lib/firefox/libnssutil3.so rm,
/usr/lib/firefox/libnss3.so rm,
/usr/lib/firefox/libsmime3.so rm,
/usr/lib/firefox/libssl3.so rm,
/usr/lib/firefox/libmozsqlite3.so rm,
/usr/lib/firefox/liblgpllibs.so rm,
/usr/lib/firefox/libxul.so rm,

/usr/lib/x86_64-linux-gnu/libfreetype.so.* rm,
/usr/lib/x86_64-linux-gnu/libfontconfig.so.* rm,
/usr/lib/x86_64-linux-gnu/libXrender.so.* rm,
/usr/lib/x86_64-linux-gnu/libXext.so.* rm,
/usr/lib/x86_64-linux-gnu/libXdamage.so.* rm,
/usr/lib/x86_64-linux-gnu/libXfixes.so.* rm,
/usr/lib/x86_64-linux-gnu/libXcomposite.so.* rm,

}
